# Forensic-Watermarking-program-for-image-CRT
해당 문서는 이전 버전의 프로그램에서 변경된 삽입/추출 과정에 대한 내용을 포함합니다.    
* 전반적인 프로그램에 대한 내용은 https://github.com/ms4935/Forensic-Watermarking-program-for-image를 참고하시기 바랍니다.

# Development contents     
**이미지 기반의 다양한 창작물들에 대하여 불법 복제와 유통이 성행하는 현재, 기존의 워터마크 활용 방식을 확장하여 이를 추적하는데 기여하는 포렌식 워터마킹 프로그램 제작을 목표로 한다.**    

* 이전 버전인 Forensic-Watermarking-program-for-image에서 삽입/추출 과정에서 **보안성 확보를 위해 중국인의 나머지 정리(CRT)** 를 적용한 버전이다.

# Development enviroment
**개발 도구**: VisualStudio 2017   
**개발 언어**: C++   
**사용 라이브러리**: MFC, OpenCV   
**개발 인원**: 4명(팀 프로젝트)    
**개발 기간**: 2019년 7월 ~ 2019년 10월

# Implement      
* **중국인의 나머지 정리(CRT)**: 



# Result    
**Lena 이미지를 대상으로 한 결과 예시**    
     
![Lena_결과화면](https://user-images.githubusercontent.com/13462458/76683089-9e6d6480-6644-11ea-9bef-5c0a05f34e7a.PNG)
     
         
**결과 검증을 위한 정량적 수치 표**  
![ver1결과](https://user-images.githubusercontent.com/13462458/76498408-29513200-6480-11ea-99de-0c21b545d447.png)     
     
     
* **PSNR(최대 신호 대 잡음비)**: 영상 또는 동영상 손실 압축에서 화질 손실 정보를 평가할 때 사용된다. 손실이 적을수록 높은 값을 가진다.(통상적으로 30db 이상의 영상은 인간의 시각 특성상 차이를 눈으로 구분하기 쉽지 않다.)      

* **NCC(정규화 상호 관계)**: 두 이미지 간의 유사도를 수치적으로 나타낸다.(1에 가까울수록 높은 유사도를 가진다.)      

**제한사항**    
* **원본 이미지의 최소 크기 제한**: 삽입 워터마크의 기준 크기를 32x32로 설정했기 때문에 **원본 이미지의 크기는 가로, 세로 크기 모두 최소 512 이상**을 만족해야한다.    
32x32 워터마크는 총 1024개의 픽셀로 구성된다. 이때, DWT 결과 부대역의 블럭 DCT 결과 8x8 블럭에 1개의 워터마크 픽셀이 삽입된다. 부대역 이미지의 블럭 DCT 결과인 8x8 블럭이 총 32x32개 즉, 1024개가 필요하기 때문에 DCT를 진행하는 **부대역 이미지는 256x256 크기를 만족해야한다**.(8x32 = 512) 따라서, 256x256 크기의 4개 부대역으로 분해되는 원본 이미지는 512x512 크기를 만족해야한다.    

* **3개의 부대역 삽입 진행**: 해당 알고리즘은 원본 이미지에 대한 DWT 결과의 4개 부대역 중 HL, LH, HH 3개 부대역에 모두 삽입을 진행한다. 각 부대역은 원본 이미지에 포함된 주파수를 각 대역별로 분할하여 나타낸다. 이런 3개의 부대역 모두에 워터마크 비트를 삽입한다는 것은 원본 이미지를 표현하는 **주파수 대역의 3/4에 삽입하는 것으로 데이터 변화가 많이 일어난다. 데이터 변화가 많을수록 삽입된 이미지는 원본 이미지와 차이가 나며 이미지 화질의 저하를 야기한다.**     

* **특정 패턴의 압축 이미지에서 추출 불가**: 저주파, 고주파 성분이 적절히 분포된 일반적인 이미지 외에 한쪽으로 치우쳐진 특정 패턴을 가진 이미지의 경우 JPEG 압축을 거친 후 추출이 불가하다. **즉, 특정 패턴을 가진 이미지를 대상으로 JPEG 압축 강인성을 확보하지 못한다.** 

**향후 발전과제**    
* **원본 이미지의 최소 크기 제한 해결 방안**: 워터마크로 사용되는 QR 코드의 구성 버전을 확인하여 **32x32 크기보다 작은 워터마크를 사용**하는 방법, 8x8 블럭 DCT보다 **작은 범위의 블럭 DCT**를 사용하는 방법, 8x8 블럭 DCT의 결과에 **두 개의 워터마크 픽셀 값(비트)를 삽입**하는 방법들을 고려해본다.    
    
* **3개의 부대역 삽입 진행 해결 방안**: 원본 이미지에 대한 영상 분석을 진행하여 HL, LH, HH 부대역 중 원본 이미지 표현에 가장 많은 값을 포함하는 부대역을 선택하여 **단일 삽입**을 진행하는 방법을 고려해본다.    
(이미지 표현에 적은 값을 포함하는 부대역에 삽입을 진행하는 경우 작은 값에 대한 변화가 결과에 큰 영향을 미친다. 하지만, 많은 값을 포함하는 부대역에 삽입을 진행하는 경우 큰 값에 대한 변화를 진행하여 이전과 큰 차이가 없으므로 결과에 작은 영향을 미친다.)    
